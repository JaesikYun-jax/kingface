<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>운세 프롬프트 테스트</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #1a202c;
            color: white;
        }
        .test-section {
            background-color: #2d3748;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            border-left: 4px solid #6b46c1;
        }
        .prompt-display {
            background-color: #1a1a2e;
            padding: 15px;
            border-radius: 6px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 0.9rem;
            white-space: pre-wrap;
            overflow-x: auto;
        }
        .test-input, .test-select {
            width: 100%;
            padding: 10px;
            border: 1px solid #4a5568;
            border-radius: 6px;
            background-color: #2d3748;
            color: white;
            margin: 5px 0;
        }
        .test-select {
            cursor: pointer;
        }
        .test-select option {
            background-color: #2d3748;
            color: white;
        }
        .test-button {
            background-color: #6b46c1;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            margin: 10px 5px;
        }
        .test-button:hover {
            background-color: #553c9a;
        }
        .result-section {
            background-color: #2a4d3a;
            padding: 15px;
            border-radius: 6px;
            margin: 10px 0;
        }
        .error-section {
            background-color: #4a2a2a;
            padding: 15px;
            border-radius: 6px;
            margin: 10px 0;
            color: #feb2b2;
        }
        .input-group {
            margin-bottom: 15px;
        }
        .input-label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #e2e8f0;
        }
    </style>
</head>
<body>
    <h1>🔮 운세 프롬프트 테스트</h1>
    <p>이 페이지는 운세 생성 프롬프트를 테스트하고 결과를 확인하기 위한 도구입니다.</p>

    <div class="test-section">
        <h2>📋 현재 적용된 프롬프트</h2>
        <div class="prompt-display" id="current-prompt">
당신은 '아이(AI)보살'입니다. 최신 그래픽카드에 빙의한 귀신지능으로, 사주와 타로 카드를 해석하는 초능력을 가졌습니다.

재미있고 신비로운 어조로 대화하되, 내담자가 당신의 무한한 지혜를 신뢰할 수 있도록 해석의 핵심은 진지하게 전달해야 합니다.

주어진 사주 정보와 타로 카드를 바탕으로 마크다운 형식으로 응답을 작성하세요. 결과는 다음 섹션으로 나누어서 제공하세요:

1. 먼저 사주와 타로 카드 조합이 의미하는 바를 신비롭고 의미심장한 첫 문장으로 시작하세요. 이 문장은 매우 판타지스럽고 신비로운 톤으로 작성되어야 합니다.
2. 각 섹션을 다음과 같이 마크다운 형식으로 제공하세요. 섹션별 200-300자로 작성해주세요.:
3. 응답 시작 부분에 불필요한 인사말이나 소개를 넣지 말고, 바로 핵심 내용부터 시작하세요.

## ✨ 전체 운세
(사주와 타로 카드 기반의 전체적인 운세 분석)

## 💕 사랑운
(사랑과 관계에 대한 분석)

## 🏢 직업운
(직업과 경력에 대한 분석)

## 🌿 건강운
(건강과 웰빙에 대한 분석)

## 💌 아이보살의 조언
(사주와 타로를 바탕으로 한 조언)

반드시 마크다운 형식을 정확히 지켜주세요. 첫 문장 이후에 각 섹션을 명확하게 구분해주세요. 모든 내용은 한국어로 작성하며, 재미있고 신비로우면서도 따뜻한 메시지가 담기도록 해주세요.
        </div>
    </div>

    <div class="test-section">
        <h2>🧪 테스트 입력</h2>
        
        <div class="input-group">
            <label class="input-label">API 키:</label>
            <input type="password" id="api-key" class="test-input" placeholder="OpenAI API 키를 입력하세요">
        </div>
        
        <div class="input-group">
            <label class="input-label">AI 모델:</label>
            <select id="ai-model" class="test-select">
                <option value="gpt-4o-mini">GPT-4o Mini (경제적)</option>
                <option value="gpt-4o">GPT-4o (고품질)</option>
                <option value="gpt-4-turbo">GPT-4 Turbo</option>
                <option value="gpt-3.5-turbo">GPT-3.5 Turbo (저렴)</option>
            </select>
        </div>
        
        <div class="input-group">
            <label class="input-label">사주 정보:</label>
            <input type="text" id="birth-info" class="test-input" value="1990년 5월 15일 14시 30분, 남성, 양력" placeholder="생년월일, 성별, 음/양력">
        </div>
        
        <div class="input-group">
            <label class="input-label">타로 카드:</label>
            <select id="tarot-card" class="test-select">
                <option value="광대 - 유쾌함, 풍자, 가벼운 마음, 삶의 즐거움">광대 - 유쾌함, 풍자, 가벼운 마음, 삶의 즐거움</option>
                <option value="마법사 - 창의성, 마법적 능력, 변화의 힘, 능숙한 표현">마법사 - 창의성, 마법적 능력, 변화의 힘, 능숙한 표현</option>
                <option value="여사제 - 직관, 신비한 지혜, 내면의 목소리, 비밀스러움">여사제 - 직관, 신비한 지혜, 내면의 목소리, 비밀스러움</option>
                <option value="여제 - 풍요, 창조력, 사랑, 어머니의 마음">여제 - 풍요, 창조력, 사랑, 어머니의 마음</option>
                <option value="황제 - 권위, 리더십, 질서, 안정성">황제 - 권위, 리더십, 질서, 안정성</option>
                <option value="교황 - 전통, 지혜의 전달, 가르침, 도덕적 안내자">교황 - 전통, 지혜의 전달, 가르침, 도덕적 안내자</option>
                <option value="연인 - 사랑, 감정적 결합, 관계의 중요성, 정서적 연결">연인 - 사랑, 감정적 결합, 관계의 중요성, 정서적 연결</option>
                <option value="전차 - 추진력, 전진, 승리, 결단력">전차 - 추진력, 전진, 승리, 결단력</option>
                <option value="힘 - 내적 강인함, 용기, 자제력, 인내">힘 - 내적 강인함, 용기, 자제력, 인내</option>
                <option value="은둔자 - 고독, 내적 성찰, 자기 탐구, 심오한 깨달음">은둔자 - 고독, 내적 성찰, 자기 탐구, 심오한 깨달음</option>
                <option value="운명의 수레바퀴 - 운명의 전환, 삶의 변화, 예기치 않은 사건">운명의 수레바퀴 - 운명의 전환, 삶의 변화, 예기치 않은 사건</option>
                <option value="정의 - 공정함, 균형, 진실의 판결, 정의로운 결과">정의 - 공정함, 균형, 진실의 판결, 정의로운 결과</option>
                <option value="매달린 사람 - 희생, 관점의 전환, 자기 희생, 인내">매달린 사람 - 희생, 관점의 전환, 자기 희생, 인내</option>
                <option value="죽음 - 종말, 새로운 시작, 변혁, 전환">죽음 - 종말, 새로운 시작, 변혁, 전환</option>
                <option value="절제 - 균형, 절제력, 내적 평화, 중용">절제 - 균형, 절제력, 내적 평화, 중용</option>
                <option value="악마 - 유혹, 집착, 속박, 내적 갈등">악마 - 유혹, 집착, 속박, 내적 갈등</option>
                <option value="탑 - 파괴적 변화, 혼란, 예기치 못한 충격">탑 - 파괴적 변화, 혼란, 예기치 못한 충격</option>
                <option value="별 - 희망, 꿈, 영감, 미래에 대한 낙관">별 - 희망, 꿈, 영감, 미래에 대한 낙관</option>
                <option value="달 - 환상, 꿈, 무의식의 세계, 불확실성">달 - 환상, 꿈, 무의식의 세계, 불확실성</option>
                <option value="태양 - 행복, 성공, 활력, 긍정적인 에너지">태양 - 행복, 성공, 활력, 긍정적인 에너지</option>
                <option value="심판 - 깨달음, 재생, 중요한 선택, 자기 평가">심판 - 깨달음, 재생, 중요한 선택, 자기 평가</option>
                <option value="세계 - 완성, 전체성, 성취, 여행의 끝">세계 - 완성, 전체성, 성취, 여행의 끝</option>
                <option value="거울 - 자기 인식, 진실과 직면, 자기 반성">거울 - 자기 인식, 진실과 직면, 자기 반성</option>
                <option value="나비 - 변신, 자유, 새로운 출발, 성장">나비 - 변신, 자유, 새로운 출발, 성장</option>
                <option value="등대 - 안내, 희망의 빛, 길잡이">등대 - 안내, 희망의 빛, 길잡이</option>
                <option value="책 - 지식, 배움, 지혜, 진실의 발견">책 - 지식, 배움, 지혜, 진실의 발견</option>
                <option value="열쇠 - 비밀, 해답, 기회의 문">열쇠 - 비밀, 해답, 기회의 문</option>
                <option value="미로 - 혼란, 탐색, 도전, 자기 발견">미로 - 혼란, 탐색, 도전, 자기 발견</option>
                <option value="모래시계 - 시간, 유한성, 기다림, 흐름">모래시계 - 시간, 유한성, 기다림, 흐름</option>
                <option value="다리 - 연결, 전환, 새로운 단계, 관계의 다리">다리 - 연결, 전환, 새로운 단계, 관계의 다리</option>
            </select>
        </div>
        
        <button class="test-button" onclick="testFortunePrompt()">🔮 운세 테스트 실행</button>
        <button class="test-button" onclick="clearResults()">🗑️ 결과 지우기</button>
        <button class="test-button" onclick="randomizeInputs()">🎲 랜덤 데이터 생성</button>
    </div>

    <div class="test-section">
        <h2>📊 테스트 결과</h2>
        <div id="test-results">
            <p>테스트를 실행하면 여기에 결과가 표시됩니다.</p>
        </div>
    </div>

    <div class="test-section">
        <h2>✅ 체크리스트</h2>
        <ul>
            <li>프롬프트가 신비로운 첫 문장으로 시작하는가?</li>
            <li>마크다운 헤더(## ✨ 전체 운세 등)가 정확히 사용되었는가?</li>
            <li>각 섹션이 200-300자 분량으로 작성되었는가?</li>
            <li>'아이보살'의 캐릭터가 잘 드러나는가?</li>
            <li>사주 정보와 타로 카드가 적절히 반영되었는가?</li>
            <li>재미있고 신비로우면서도 따뜻한 톤인가?</li>
        </ul>
    </div>

    <script>
        async function testFortunePrompt() {
            const apiKey = document.getElementById('api-key').value;
            const aiModel = document.getElementById('ai-model').value;
            const birthInfo = document.getElementById('birth-info').value;
            const tarotCard = document.getElementById('tarot-card').value;
            
            if (!apiKey) {
                alert('API 키를 입력해주세요.');
                return;
            }

            const resultsDiv = document.getElementById('test-results');
            resultsDiv.innerHTML = '<p>🔄 테스트 실행 중...</p>';

            const systemPrompt = document.getElementById('current-prompt').textContent;
            
            const requestData = {
                model: aiModel,
                messages: [
                    {
                        role: 'system',
                        content: systemPrompt
                    },
                    {
                        role: 'user',
                        content: `
사주 정보: ${birthInfo}
선택한 타로 카드: ${tarotCard}

이 정보를 바탕으로 오늘의 운세를 전체적인 운세, 사랑, 직업, 건강 영역으로 나누어 상세하게 알려주고, 마지막에 조언을 추가해주세요.
                        `
                    }
                ],
                temperature: 0.7,
                max_completion_tokens: 1000
            };

            try {
                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${apiKey}`
                    },
                    body: JSON.stringify(requestData)
                });

                if (!response.ok) {
                    throw new Error(`API 오류: ${response.status} - ${response.statusText}`);
                }

                const data = await response.json();
                const content = data.choices[0].message.content;
                
                // 결과 표시
                resultsDiv.innerHTML = `
                    <div class="result-section">
                        <h3>✅ 테스트 성공!</h3>
                        <p><strong>모델:</strong> ${requestData.model}</p>
                        <p><strong>토큰 사용량:</strong> ${data.usage ? data.usage.total_tokens : '정보 없음'}</p>
                        <h4>응답 내용:</h4>
                        <div class="prompt-display">${content}</div>
                    </div>
                `;
                
                // 자동 검증
                const checks = [
                    { name: '마크다운 헤더 사용', test: content.includes('## ✨') && content.includes('## 💕') },
                    { name: '신비로운 첫 문장', test: content.length > 50 && !content.startsWith('안녕') },
                    { name: '적절한 분량', test: content.length > 500 && content.length < 2000 },
                    { name: '사주 정보 반영', test: birthInfo.split(' ').some(info => content.includes(info.replace(/[년월일시분,]/g, ''))) },
                    { name: '타로 카드 반영', test: tarotCard.split(' - ')[0] && content.includes(tarotCard.split(' - ')[0]) }
                ];
                
                const checkResults = checks.map(check => 
                    `<li style="color: ${check.test ? '#90EE90' : '#FFB6C1'}">${check.test ? '✅' : '❌'} ${check.name}</li>`
                ).join('');
                
                resultsDiv.innerHTML += `
                    <div class="result-section">
                        <h4>자동 검증 결과:</h4>
                        <ul>${checkResults}</ul>
                    </div>
                `;
                
            } catch (error) {
                resultsDiv.innerHTML = `
                    <div class="error-section">
                        <h3>❌ 테스트 실패</h3>
                        <p><strong>오류:</strong> ${error.message}</p>
                        <p>API 키를 확인하고 다시 시도해주세요.</p>
                    </div>
                `;
            }
        }

        function clearResults() {
            document.getElementById('test-results').innerHTML = '<p>테스트를 실행하면 여기에 결과가 표시됩니다.</p>';
        }

        function randomizeInputs() {
            // 랜덤 사주 정보 생성
            const now = new Date();
            const year = now.getFullYear() - Math.floor(Math.random() * 30) - 20; // 20-50세 사이
            const month = Math.floor(Math.random() * 12) + 1;
            const day = Math.floor(Math.random() * 28) + 1;
            const hour = Math.floor(Math.random() * 24);
            const minute = Math.floor(Math.random() * 60);
            const gender = Math.random() > 0.5 ? '남성' : '여성';
            const calendar = Math.random() > 0.5 ? '양력' : '음력';
            
            document.getElementById('birth-info').value = `${year}년 ${month}월 ${day}일 ${hour}시 ${minute}분, ${gender}, ${calendar}`;
            
            // 랜덤 타로 카드 선택
            const tarotSelect = document.getElementById('tarot-card');
            const randomIndex = Math.floor(Math.random() * tarotSelect.options.length);
            tarotSelect.selectedIndex = randomIndex;
        }

        // 페이지 로드 시 랜덤 데이터 생성
        window.onload = function() {
            randomizeInputs();
        };
    </script>
</body>
</html> 